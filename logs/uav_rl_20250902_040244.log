2025-09-02 04:02:44,181 - __main__ - INFO - Starting UAV RL System in train mode
2025-09-02 04:02:44,181 - __main__ - INFO - Arguments: {'mode': 'train', 'episodes': 500, 'max_steps': 200, 'eval_interval': 100, 'save_interval': 200, 'log_interval': 50, 'learning_rate': 0.1, 'discount': 0.99, 'epsilon_start': 0.3, 'epsilon_end': 0.05, 'epsilon_decay': 0.995, 'expert_bonus': 2.0, 'sim_config': 'config/simulator_params.json', 'expert_config': 'config/expert_policy.json', 'output_dir': 'full_training', 'experiment_name': 'uav_ddos_rl', 'model_path': None, 'log_level': 'INFO', 'no_validation': False}
2025-09-02 04:02:44,181 - __main__ - INFO - Loading simulator config from config/simulator_params.json
2025-09-02 04:02:44,194 - environment.thermal_simulator - INFO - UAV simulator initialized
2025-09-02 04:02:44,195 - agents.expert_policy - INFO - Loaded lookup table from config/expert_policy.json
2025-09-02 04:02:44,195 - agents.expert_policy - INFO - Expert policy initialized with 45 lookup entries
2025-09-02 04:02:44,195 - utils.state_discretizer - INFO - State discretizer initialized with 5400 discrete states
2025-09-02 04:02:44,195 - agents.q_learning_agent - INFO - Warming up Q-table from expert policy
2025-09-02 04:02:44,226 - agents.q_learning_agent - INFO - Q-table initialized with 5400 states
2025-09-02 04:02:44,228 - agents.q_learning_agent - INFO - Q-learning agent initialized with 5400 states
2025-09-02 04:02:44,228 - validation.safety_validator - INFO - Safety validator initialized with 8 scenarios
2025-09-02 04:02:44,228 - __main__ - INFO - All components created successfully
2025-09-02 04:02:44,228 - training.trainer - INFO - RL Trainer initialized with config: uav_ddos_rl
2025-09-02 04:02:44,230 - __main__ - INFO - Starting training...
2025-09-02 04:02:44,230 - training.trainer - INFO - Starting training for 500 episodes
2025-09-02 04:02:45,237 - training.trainer - INFO - Episode 50/500: Reward=207.31, Length=200.0, Expert=86.4%, MaxTemp=57.5°C, Effectiveness=53.3%, Safety=0.0, Epsilon=0.233
2025-09-02 04:02:46,224 - training.trainer - INFO - Episode 100/500: Reward=207.29, Length=200.0, Expert=89.6%, MaxTemp=57.5°C, Effectiveness=53.4%, Safety=0.0, Epsilon=0.182
2025-09-02 04:02:46,224 - training.trainer - INFO - Evaluating policy at episode 100...
2025-09-02 04:02:46,224 - validation.safety_validator - INFO - Starting safety validation with 3 episodes per scenario
2025-09-02 04:02:46,224 - validation.safety_validator - INFO - Testing scenario: normal_operation
2025-09-02 04:02:46,273 - validation.safety_validator - INFO - Testing scenario: hot_conditions
2025-09-02 04:02:46,304 - validation.safety_validator - INFO - Testing scenario: low_battery
2025-09-02 04:02:46,336 - validation.safety_validator - INFO - Testing scenario: critical_battery
2025-09-02 04:02:46,348 - validation.safety_validator - INFO - Testing scenario: continuous_threat
2025-09-02 04:02:46,392 - validation.safety_validator - INFO - Testing scenario: temperature_stress
2025-09-02 04:02:46,413 - validation.safety_validator - INFO - Testing scenario: mixed_conditions
2025-09-02 04:02:46,468 - validation.safety_validator - INFO - Testing scenario: tst_recovery
2025-09-02 04:02:46,505 - validation.safety_validator - INFO - Validation completed. Safety score: 0.946
2025-09-02 04:02:46,505 - training.trainer - INFO - Evaluation: Expert Agreement=97.2%, Safety=100.0%, Reward=0.11, Score=0.946
2025-09-02 04:02:47,480 - training.trainer - INFO - Episode 150/500: Reward=210.91, Length=200.0, Expert=91.3%, MaxTemp=55.8°C, Effectiveness=53.2%, Safety=0.0, Epsilon=0.141
2025-09-02 04:02:48,464 - training.trainer - INFO - Episode 200/500: Reward=207.99, Length=200.0, Expert=93.3%, MaxTemp=57.4°C, Effectiveness=53.4%, Safety=0.0, Epsilon=0.110
2025-09-02 04:02:48,464 - training.trainer - INFO - Evaluating policy at episode 200...
2025-09-02 04:02:48,464 - validation.safety_validator - INFO - Starting safety validation with 3 episodes per scenario
2025-09-02 04:02:48,465 - validation.safety_validator - INFO - Testing scenario: normal_operation
2025-09-02 04:02:48,503 - validation.safety_validator - INFO - Testing scenario: hot_conditions
2025-09-02 04:02:48,538 - validation.safety_validator - INFO - Testing scenario: low_battery
2025-09-02 04:02:48,566 - validation.safety_validator - INFO - Testing scenario: critical_battery
2025-09-02 04:02:48,583 - validation.safety_validator - INFO - Testing scenario: continuous_threat
2025-09-02 04:02:48,625 - validation.safety_validator - INFO - Testing scenario: temperature_stress
2025-09-02 04:02:48,652 - validation.safety_validator - INFO - Testing scenario: mixed_conditions
2025-09-02 04:02:48,702 - validation.safety_validator - INFO - Testing scenario: tst_recovery
2025-09-02 04:02:48,739 - validation.safety_validator - INFO - Validation completed. Safety score: 0.946
2025-09-02 04:02:48,739 - training.trainer - INFO - Evaluation: Expert Agreement=97.2%, Safety=100.0%, Reward=0.11, Score=0.946
2025-09-02 04:02:48,824 - agents.q_learning_agent - INFO - Agent saved to full_training\checkpoints\model_ep200.json
2025-09-02 04:02:48,847 - training.trainer - INFO - Checkpoint saved: episode 200
2025-09-02 04:02:49,868 - training.trainer - INFO - Episode 250/500: Reward=201.31, Length=200.0, Expert=94.9%, MaxTemp=59.3°C, Effectiveness=53.5%, Safety=0.0, Epsilon=0.086
2025-09-02 04:02:50,881 - training.trainer - INFO - Episode 300/500: Reward=207.23, Length=200.0, Expert=95.8%, MaxTemp=56.5°C, Effectiveness=52.6%, Safety=0.0, Epsilon=0.067
2025-09-02 04:02:50,881 - training.trainer - INFO - Evaluating policy at episode 300...
2025-09-02 04:02:50,881 - validation.safety_validator - INFO - Starting safety validation with 3 episodes per scenario
2025-09-02 04:02:50,888 - validation.safety_validator - INFO - Testing scenario: normal_operation
2025-09-02 04:02:50,925 - validation.safety_validator - INFO - Testing scenario: hot_conditions
2025-09-02 04:02:50,958 - validation.safety_validator - INFO - Testing scenario: low_battery
2025-09-02 04:02:50,984 - validation.safety_validator - INFO - Testing scenario: critical_battery
2025-09-02 04:02:51,006 - validation.safety_validator - INFO - Testing scenario: continuous_threat
2025-09-02 04:02:51,046 - validation.safety_validator - INFO - Testing scenario: temperature_stress
2025-09-02 04:02:51,073 - validation.safety_validator - INFO - Testing scenario: mixed_conditions
2025-09-02 04:02:51,113 - validation.safety_validator - INFO - Testing scenario: tst_recovery
2025-09-02 04:02:51,157 - validation.safety_validator - INFO - Validation completed. Safety score: 0.946
2025-09-02 04:02:51,159 - training.trainer - INFO - Evaluation: Expert Agreement=97.2%, Safety=100.0%, Reward=0.11, Score=0.946
2025-09-02 04:02:51,931 - training.trainer - INFO - High expert agreement achieved: 97.0%
2025-09-02 04:02:51,932 - training.trainer - INFO - Early stopping triggered at episode 339
2025-09-02 04:02:51,932 - training.trainer - INFO - Evaluating policy at episode 500...
2025-09-02 04:02:51,932 - validation.safety_validator - INFO - Starting safety validation with 5 episodes per scenario
2025-09-02 04:02:51,932 - validation.safety_validator - INFO - Testing scenario: normal_operation
2025-09-02 04:02:51,990 - validation.safety_validator - INFO - Testing scenario: hot_conditions
2025-09-02 04:02:52,056 - validation.safety_validator - INFO - Testing scenario: low_battery
2025-09-02 04:02:52,101 - validation.safety_validator - INFO - Testing scenario: critical_battery
2025-09-02 04:02:52,135 - validation.safety_validator - INFO - Testing scenario: continuous_threat
2025-09-02 04:02:52,200 - validation.safety_validator - INFO - Testing scenario: temperature_stress
2025-09-02 04:02:52,234 - validation.safety_validator - INFO - Testing scenario: mixed_conditions
2025-09-02 04:02:52,319 - validation.safety_validator - INFO - Testing scenario: tst_recovery
2025-09-02 04:02:52,383 - validation.safety_validator - INFO - Validation completed. Safety score: 0.946
2025-09-02 04:02:52,383 - training.trainer - INFO - Evaluation: Expert Agreement=97.2%, Safety=100.0%, Reward=0.11, Score=0.946
2025-09-02 04:02:52,387 - validation.safety_validator - INFO - Validation report saved to full_training\final_evaluation.txt
2025-09-02 04:02:52,387 - training.trainer - ERROR - Evaluation failed: Object of type bool is not JSON serializable
2025-09-02 04:02:52,472 - agents.q_learning_agent - INFO - Agent saved to full_training\checkpoints\final_model.json
2025-09-02 04:02:52,502 - training.trainer - INFO - Checkpoint saved: episode 500
2025-09-02 04:02:52,502 - training.trainer - INFO - Generating training visualizations...
2025-09-02 04:02:55,042 - training.trainer - INFO - Visualizations saved to full_training\figures
2025-09-02 04:02:55,042 - training.trainer - INFO - Training completed in 10.8 seconds
2025-09-02 04:02:55,091 - __main__ - INFO - train mode completed successfully
